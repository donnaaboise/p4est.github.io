<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>p4est: example/steps/p4est_step3.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">p4est
   &#160;<span id="projectnumber">1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_cfafba98a580ce4b62f8a6fa96d7cbb0.html">example</a></li><li class="navelem"><a class="el" href="dir_f8749247d154dad11ecedde9fb423262.html">steps</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">p4est_step3.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This 2D example program uses p4est to solve a simple advection problem.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="p4est__vtk_8h_source.html">p4est_vtk.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="p4est__bits_8h_source.html">p4est_bits.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="p4est__extended_8h_source.html">p4est_extended.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="p4est__iterate_8h_source.html">p4est_iterate.h</a>&gt;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstep3__data__t.html">step3_data_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Per-quadrant data for this example.  <a href="structstep3__data__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstep3__ctx__t.html">step3_ctx_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The example parameters.  <a href="structstep3__ctx__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad22806e8db2f96857ca9cd660af24d77"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#ad22806e8db2f96857ca9cd660af24d77">step3_initial_condition</a> (double x[], double du[], <a class="el" href="structstep3__ctx__t.html">step3_ctx_t</a> *ctx)</td></tr>
<tr class="memdesc:ad22806e8db2f96857ca9cd660af24d77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value and derivatives of the initial condition.  <a href="#ad22806e8db2f96857ca9cd660af24d77">More...</a><br/></td></tr>
<tr class="separator:ad22806e8db2f96857ca9cd660af24d77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79136238106c3137475069b64c07004e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a79136238106c3137475069b64c07004e">step3_get_midpoint</a> (<a class="el" href="structp4est__t.html">p4est_t</a> *p4est, <a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree, <a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *q, double xyz[3])</td></tr>
<tr class="memdesc:a79136238106c3137475069b64c07004e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the coordinates of the midpoint of a quadrant.  <a href="#a79136238106c3137475069b64c07004e">More...</a><br/></td></tr>
<tr class="separator:a79136238106c3137475069b64c07004e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a554fae21a1b79d208e45c47506a861f9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a554fae21a1b79d208e45c47506a861f9">step3_init_initial_condition</a> (<a class="el" href="structp4est__t.html">p4est_t</a> *p4est, <a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree, <a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *q)</td></tr>
<tr class="memdesc:a554fae21a1b79d208e45c47506a861f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the initial condition data of a quadrant.  <a href="#a554fae21a1b79d208e45c47506a861f9">More...</a><br/></td></tr>
<tr class="separator:a554fae21a1b79d208e45c47506a861f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a216c78f1f35a9bded7e79a22bbc0f442"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a216c78f1f35a9bded7e79a22bbc0f442">step3_error_sqr_estimate</a> (<a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *q)</td></tr>
<tr class="memdesc:a216c78f1f35a9bded7e79a22bbc0f442"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimate the square of the approximation error on a quadrant.  <a href="#a216c78f1f35a9bded7e79a22bbc0f442">More...</a><br/></td></tr>
<tr class="separator:a216c78f1f35a9bded7e79a22bbc0f442"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae157bd96012486d0dbe867c390428971"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#ae157bd96012486d0dbe867c390428971">step3_refine_err_estimate</a> (<a class="el" href="structp4est__t.html">p4est_t</a> *p4est, <a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree, <a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *q)</td></tr>
<tr class="memdesc:ae157bd96012486d0dbe867c390428971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine by the L2 error estimate.  <a href="#ae157bd96012486d0dbe867c390428971">More...</a><br/></td></tr>
<tr class="separator:ae157bd96012486d0dbe867c390428971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae777d82e412b0ec45d1cac34680fb52"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#aae777d82e412b0ec45d1cac34680fb52">step3_coarsen_initial_condition</a> (<a class="el" href="structp4est__t.html">p4est_t</a> *p4est, <a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree, <a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *children[])</td></tr>
<tr class="memdesc:aae777d82e412b0ec45d1cac34680fb52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coarsen by the L2 error estimate of the initial condition.  <a href="#aae777d82e412b0ec45d1cac34680fb52">More...</a><br/></td></tr>
<tr class="separator:aae777d82e412b0ec45d1cac34680fb52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18ae7f61cff736785c84c1330b191e69"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a18ae7f61cff736785c84c1330b191e69">step3_coarsen_err_estimate</a> (<a class="el" href="structp4est__t.html">p4est_t</a> *p4est, <a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree, <a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *children[])</td></tr>
<tr class="memdesc:a18ae7f61cff736785c84c1330b191e69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coarsen by the L2 error estimate of the current state approximation.  <a href="#a18ae7f61cff736785c84c1330b191e69">More...</a><br/></td></tr>
<tr class="separator:a18ae7f61cff736785c84c1330b191e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af14f24bfb35ca41a10de5ae4335a8103"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#af14f24bfb35ca41a10de5ae4335a8103">step3_replace_quads</a> (<a class="el" href="structp4est__t.html">p4est_t</a> *p4est, <a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a> which_tree, int num_outgoing, <a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *outgoing[], int num_incoming, <a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *incoming[])</td></tr>
<tr class="memdesc:af14f24bfb35ca41a10de5ae4335a8103"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the state variables of incoming quadrants from outgoing quadrants.  <a href="#af14f24bfb35ca41a10de5ae4335a8103">More...</a><br/></td></tr>
<tr class="separator:af14f24bfb35ca41a10de5ae4335a8103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9912df4af55ccbb50dadf84122e6d22f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a9912df4af55ccbb50dadf84122e6d22f">step3_interpolate_solution</a> (<a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *info, void *user_data)</td></tr>
<tr class="memdesc:a9912df4af55ccbb50dadf84122e6d22f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for interpolating the solution from quadrant midpoints to corners.  <a href="#a9912df4af55ccbb50dadf84122e6d22f">More...</a><br/></td></tr>
<tr class="separator:a9912df4af55ccbb50dadf84122e6d22f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f1dc6e9533b02dea22f550b895e6aa2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a6f1dc6e9533b02dea22f550b895e6aa2">step3_write_solution</a> (<a class="el" href="structp4est__t.html">p4est_t</a> *p4est, int timestep)</td></tr>
<tr class="memdesc:a6f1dc6e9533b02dea22f550b895e6aa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the state variable to vtk format, one file per process.  <a href="#a6f1dc6e9533b02dea22f550b895e6aa2">More...</a><br/></td></tr>
<tr class="separator:a6f1dc6e9533b02dea22f550b895e6aa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3c41c13b4f5fcc2dbd1bd74d8341198"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#af3c41c13b4f5fcc2dbd1bd74d8341198">step3_quad_divergence</a> (<a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *info, void *user_data)</td></tr>
<tr class="memdesc:af3c41c13b4f5fcc2dbd1bd74d8341198"><td class="mdescLeft">&#160;</td><td class="mdescRight">Approximate the divergence of (vu) on each quadrant.  <a href="#af3c41c13b4f5fcc2dbd1bd74d8341198">More...</a><br/></td></tr>
<tr class="separator:af3c41c13b4f5fcc2dbd1bd74d8341198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba3d789bf6ffb41a104f37fef7766d6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#abba3d789bf6ffb41a104f37fef7766d6">step3_upwind_flux</a> (<a class="el" href="structp4est__iter__face__info__t.html">p4est_iter_face_info_t</a> *info, void *user_data)</td></tr>
<tr class="memdesc:abba3d789bf6ffb41a104f37fef7766d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Approximate the flux across a boundary between quadrants.  <a href="#abba3d789bf6ffb41a104f37fef7766d6">More...</a><br/></td></tr>
<tr class="separator:abba3d789bf6ffb41a104f37fef7766d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de3caa7cd107b13dfdf9e90b25730ad"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a0de3caa7cd107b13dfdf9e90b25730ad">step3_timestep_update</a> (<a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *info, void *user_data)</td></tr>
<tr class="memdesc:a0de3caa7cd107b13dfdf9e90b25730ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the new value of the state from the computed time derivative.  <a href="#a0de3caa7cd107b13dfdf9e90b25730ad">More...</a><br/></td></tr>
<tr class="separator:a0de3caa7cd107b13dfdf9e90b25730ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ba9559c8ef3c36f82ae6302796cb8f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#ac9ba9559c8ef3c36f82ae6302796cb8f">step3_reset_derivatives</a> (<a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *info, void *user_data)</td></tr>
<tr class="memdesc:ac9ba9559c8ef3c36f82ae6302796cb8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the approximate derivatives.  <a href="#ac9ba9559c8ef3c36f82ae6302796cb8f">More...</a><br/></td></tr>
<tr class="separator:ac9ba9559c8ef3c36f82ae6302796cb8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d3801356a2884d17ce21eb25eefe7cc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a3d3801356a2884d17ce21eb25eefe7cc">step3_minmod_estimate</a> (<a class="el" href="structp4est__iter__face__info__t.html">p4est_iter_face_info_t</a> *info, void *user_data)</td></tr>
<tr class="memdesc:a3d3801356a2884d17ce21eb25eefe7cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">For two quadrants on either side of a face, estimate the derivative normal to the face.  <a href="#a3d3801356a2884d17ce21eb25eefe7cc">More...</a><br/></td></tr>
<tr class="separator:a3d3801356a2884d17ce21eb25eefe7cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab75a694faaccbea92c4b8e1bc7979983"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#ab75a694faaccbea92c4b8e1bc7979983">step3_compute_max</a> (<a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *info, void *user_data)</td></tr>
<tr class="memdesc:ab75a694faaccbea92c4b8e1bc7979983"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the maximum state value.  <a href="#ab75a694faaccbea92c4b8e1bc7979983">More...</a><br/></td></tr>
<tr class="separator:ab75a694faaccbea92c4b8e1bc7979983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40970a57c6f27ac705c4cd9f15dbf8d4"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a40970a57c6f27ac705c4cd9f15dbf8d4">step3_get_timestep</a> (<a class="el" href="structp4est__t.html">p4est_t</a> *p4est)</td></tr>
<tr class="memdesc:a40970a57c6f27ac705c4cd9f15dbf8d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the timestep.  <a href="#a40970a57c6f27ac705c4cd9f15dbf8d4">More...</a><br/></td></tr>
<tr class="separator:a40970a57c6f27ac705c4cd9f15dbf8d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecdb0d252f5c08f3e0629442755e22c6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#aecdb0d252f5c08f3e0629442755e22c6">step3_timestep</a> (<a class="el" href="structp4est__t.html">p4est_t</a> *p4est, double time)</td></tr>
<tr class="memdesc:aecdb0d252f5c08f3e0629442755e22c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestep the advection problem.  <a href="#aecdb0d252f5c08f3e0629442755e22c6">More...</a><br/></td></tr>
<tr class="separator:aecdb0d252f5c08f3e0629442755e22c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p4est__step3_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="memdesc:a3c04138a5bfe5d72780bb7e82a18e627"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main step 3 program.  <a href="#a3c04138a5bfe5d72780bb7e82a18e627">More...</a><br/></td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This 2D example program uses p4est to solve a simple advection problem. </p>
<p>It is numerically very simple, and intended to demonstrate several methods of interacting with the p4est data after it has been refined and partitioned. It demonstrates the construction of ghost layers (see <a class="el" href="structp4est__ghost__t.html" title="quadrants that neighbor the local domain ">p4est_ghost_t</a> in <a class="el" href="p4est__ghost_8h.html" title="passing quadrants and data to neighboring processes ">p4est_ghost.h</a>) and communication of ghost-layer data, and it demonstrates interacting with the quadrants and quadrant boundaries through the <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> routine (see <a class="el" href="p4est__iterate_8h.html" title="Iteration over mesh topology via callbacks. ">p4est_iterate.h</a>). </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main step 3 program. </p>
<p>Setup of the example parameters; create the forest, with the state variable stored in the quadrant data; refine, balance, and partition the forest; timestep; clean up, and exit. </p>

</div>
</div>
<a class="anchor" id="a18ae7f61cff736785c84c1330b191e69"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int step3_coarsen_err_estimate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__t.html">p4est_t</a> *&#160;</td>
          <td class="paramname"><em>p4est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a>&#160;</td>
          <td class="paramname"><em>which_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *&#160;</td>
          <td class="paramname"><em>children</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Coarsen by the L2 error estimate of the current state approximation. </p>
<p>Given the maximum global error, we enforce that each quadrant's portion of the error must not exceed its fraction of the total volume of the domain (which is 1).</p>
<p>This function matches the p4est_coarsen_t prototype that is used by <a class="el" href="p4est_8h.html#ad250f4765d9778ec3940e9fabea7c853" title="Coarsen a forest. ">p4est_coarsen()</a> and <a class="el" href="p4est__extended_8h.html#a06630b99f70cb85c73452640e8b4d54e" title="Coarsen a forest. ">p4est_coarsen_ext()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p4est</td><td>the forest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">which_tree</td><td>the tree in the forest containing <em>children</em> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">children</td><td>a family of quadrants</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if <em>children</em> should be coarsened, 0 otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="aae777d82e412b0ec45d1cac34680fb52"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int step3_coarsen_initial_condition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__t.html">p4est_t</a> *&#160;</td>
          <td class="paramname"><em>p4est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a>&#160;</td>
          <td class="paramname"><em>which_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *&#160;</td>
          <td class="paramname"><em>children</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Coarsen by the L2 error estimate of the initial condition. </p>
<p>Given the maximum global error, we enforce that each quadrant's portion of the error must not exceed is fraction of the total volume of the domain (which is 1).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p4est</td><td>the forest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">which_tree</td><td>the tree in the forest containing <em>children</em> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">children</td><td>a family of quadrants</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if <em>children</em> should be coarsened, 0 otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="ab75a694faaccbea92c4b8e1bc7979983"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_compute_max </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the maximum state value. </p>
<p>This function updates the maximum value from the value of a single cell.</p>
<p>This function matches the p4est_iter_volume_t prototype used by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>the information about this quadrant that has been populated by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user_data</td><td>the user_data given to <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>: in this case, it points to the maximum value that will be updated </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a216c78f1f35a9bded7e79a22bbc0f442"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double step3_error_sqr_estimate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Estimate the square of the approximation error on a quadrant. </p>
<p>We compute our estimate by integrating the difference of a constant approximation at the midpoint and a linear approximation that interpolates at the midpoint.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>a quadrant</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the square of the error estimate for the state variables contained in <em>q's</em> data. </dd></dl>

</div>
</div>
<a class="anchor" id="a79136238106c3137475069b64c07004e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_get_midpoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__t.html">p4est_t</a> *&#160;</td>
          <td class="paramname"><em>p4est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a>&#160;</td>
          <td class="paramname"><em>which_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xyz</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the coordinates of the midpoint of a quadrant. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p4est</td><td>the forest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">which_tree</td><td>the tree in the forest containing <em>q</em> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>the quadrant </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xyz</td><td>the coordinates of the midpoint of <em>q</em> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a40970a57c6f27ac705c4cd9f15dbf8d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double step3_get_timestep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__t.html">p4est_t</a> *&#160;</td>
          <td class="paramname"><em>p4est</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the timestep. </p>
<p>Find the smallest quadrant and scale the timestep based on that length and the advection velocity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p4est</td><td>the forest </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the timestep. </dd></dl>

</div>
</div>
<a class="anchor" id="a554fae21a1b79d208e45c47506a861f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_init_initial_condition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__t.html">p4est_t</a> *&#160;</td>
          <td class="paramname"><em>p4est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a>&#160;</td>
          <td class="paramname"><em>which_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the initial condition data of a quadrant. </p>
<p>This function matches the p4est_init_t prototype that is used by <a class="el" href="p4est_8h.html#ac10dc6f325322ad6af793c5b6acbf4c2" title="Create a new forest. ">p4est_new()</a>, <a class="el" href="p4est_8h.html#a1a31375edfa42b5609e7656233c32cca" title="Refine a forest. ">p4est_refine()</a>, <a class="el" href="p4est_8h.html#ad250f4765d9778ec3940e9fabea7c853" title="Coarsen a forest. ">p4est_coarsen()</a>, and <a class="el" href="p4est_8h.html#a6b603736cf5007b14755197a9c179a85" title="2:1 balance the size differences of neighboring elements in a forest. ">p4est_balance()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p4est</td><td>the forest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">which_tree</td><td>the tree in the forest containing <em>q</em> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>the quadrant whose data gets initialized </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad22806e8db2f96857ca9cd660af24d77"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double step3_initial_condition </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>du</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstep3__ctx__t.html">step3_ctx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the value and derivatives of the initial condition. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>the coordinates </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">du</td><td>the derivative at <em>x</em> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>the example parameters</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the initial condition at <em>x</em> </dd></dl>

</div>
</div>
<a class="anchor" id="a9912df4af55ccbb50dadf84122e6d22f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_interpolate_solution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function for interpolating the solution from quadrant midpoints to corners. </p>
<p>The function <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> takes as an argument a p4est_iter_volume_t callback function, which it executes at every local quadrant (see <a class="el" href="p4est__iterate_8h.html" title="Iteration over mesh topology via callbacks. ">p4est_iterate.h</a>). This function matches the p4est_iter_volume_t prototype.</p>
<p>In this example, we use the callback function to interpolate the state variable to the corners, and write those corners into an array so that they can be written out.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>the information about this quadrant that has been populated by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user_data</td><td>the user_data that was given as an argument to p4est_iterate: in this case, it points to the array of corner values that we want to write. The values for the corner of the quadrant described by <em>info</em> are written during the execution of the callback. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3d3801356a2884d17ce21eb25eefe7cc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_minmod_estimate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__iter__face__info__t.html">p4est_iter_face_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For two quadrants on either side of a face, estimate the derivative normal to the face. </p>
<p>This function matches the p4est_iter_face_t prototype used by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>the information about this quadrant that has been populated by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user_data</td><td>the user_data given to <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>: in this case, it points to the ghost_data array, which contains the <a class="el" href="structstep3__data__t.html" title="Per-quadrant data for this example. ">step3_data_t</a> data for all of the ghost cells, which was populated by <a class="el" href="p4est__ghost_8h.html#a58908a7bf0810077c99a6ddccc642fcd" title="Transfer data for local quadrants that are ghosts to other processors. ">p4est_ghost_exchange_data()</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af3c41c13b4f5fcc2dbd1bd74d8341198"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_quad_divergence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Approximate the divergence of (vu) on each quadrant. </p>
<p>We use piecewise constant approximations on each quadrant, so the value is always 0.</p>
<p>Like <a class="el" href="p4est__step3_8c.html#a9912df4af55ccbb50dadf84122e6d22f" title="Callback function for interpolating the solution from quadrant midpoints to corners. ">step3_interpolate_solution()</a>, this function matches the p4est_iter_volume_t prototype used by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>the information about the quadrant populated by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user_data</td><td>not used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae157bd96012486d0dbe867c390428971"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int step3_refine_err_estimate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__t.html">p4est_t</a> *&#160;</td>
          <td class="paramname"><em>p4est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a>&#160;</td>
          <td class="paramname"><em>which_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refine by the L2 error estimate. </p>
<p>Given the maximum global error, we enforce that each quadrant's portion of the error must not exceed is fraction of the total volume of the domain (which is 1).</p>
<p>This function matches the p4est_refine_t prototype that is used by <a class="el" href="p4est_8h.html#a1a31375edfa42b5609e7656233c32cca" title="Refine a forest. ">p4est_refine()</a> and <a class="el" href="p4est__extended_8h.html#aad32df9df3630b6bac05e7366a5f1e46" title="Refine a forest with a bounded refinement level and a replace option. ">p4est_refine_ext()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p4est</td><td>the forest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">which_tree</td><td>the tree in the forest containing <em>q</em> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>the quadrant</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if <em>q</em> should be refined, 0 otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="af14f24bfb35ca41a10de5ae4335a8103"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_replace_quads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__t.html">p4est_t</a> *&#160;</td>
          <td class="paramname"><em>p4est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="p4est__base_8h.html#a8e849f705b0d4d1702b8f5102823f48c">p4est_topidx_t</a>&#160;</td>
          <td class="paramname"><em>which_tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_outgoing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *&#160;</td>
          <td class="paramname"><em>outgoing</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_incoming</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structp4est__quadrant__t.html">p4est_quadrant_t</a> *&#160;</td>
          <td class="paramname"><em>incoming</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the state variables of incoming quadrants from outgoing quadrants. </p>
<p>The functions <a class="el" href="p4est__extended_8h.html#aad32df9df3630b6bac05e7366a5f1e46" title="Refine a forest with a bounded refinement level and a replace option. ">p4est_refine_ext()</a>, <a class="el" href="p4est__extended_8h.html#a06630b99f70cb85c73452640e8b4d54e" title="Coarsen a forest. ">p4est_coarsen_ext()</a>, and <a class="el" href="p4est__extended_8h.html#a666a197be8d6d83c08cc14bfdc8565ed" title="2:1 balance the size differences of neighboring elements in a forest. ">p4est_balance_ext()</a> take as an argument a p4est_replace_t callback function, which allows one to setup the quadrant data of incoming quadrants from the data of outgoing quadrants, before the outgoing data is destroyed. This function matches the p4est_replace_t prototype.</p>
<p>In this example, we linearly interpolate the state variable of a quadrant that is refined to its children, and we average the midpoints of children that are being coarsened to the parent.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p4est</td><td>the forest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">which_tree</td><td>the tree in the forest containing <em>children</em> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_outgoing</td><td>the number of quadrants that are being replaced: either 1 if a quadrant is being refined, or P4EST_CHILDREN if a family of children are being coarsened. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outgoing</td><td>the outgoing quadrants </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_incoming</td><td>the number of quadrants that are being added: either P4EST_CHILDREN if a quadrant is being refined, or 1 if a family of children are being coarsened. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">incoming</td><td>quadrants whose data are initialized. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac9ba9559c8ef3c36f82ae6302796cb8f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_reset_derivatives </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset the approximate derivatives. </p>
<p><a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> has an invariant to the order of callback execution: the p4est_iter_volume_t callback will be executed on a quadrant before the p4est_iter_face_t callbacks are executed on its faces. This function resets the derivative stored in the quadrant's data before <a class="el" href="p4est__step3_8c.html#a3d3801356a2884d17ce21eb25eefe7cc" title="For two quadrants on either side of a face, estimate the derivative normal to the face...">step3_minmod_estimate()</a> updates the derivative based on the face neighbors.</p>
<p>This function matches the p4est_iter_volume_t prototype used by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>the information about this quadrant that has been populated by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user_data</td><td>not used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aecdb0d252f5c08f3e0629442755e22c6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_timestep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__t.html">p4est_t</a> *&#160;</td>
          <td class="paramname"><em>p4est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Timestep the advection problem. </p>
<p>Update the state, refine, repartition, and write the solution to file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p4est</td><td>the forest, whose state is updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>the end time </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0de3caa7cd107b13dfdf9e90b25730ad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_timestep_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__iter__volume__info__t.html">p4est_iter_volume_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the new value of the state from the computed time derivative. </p>
<p>We use a simple forward Euler scheme.</p>
<p>The derivative was computed by a <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> loop by the callbacks <a class="el" href="p4est__step3_8c.html#af3c41c13b4f5fcc2dbd1bd74d8341198" title="Approximate the divergence of (vu) on each quadrant. ">step3_quad_divergence()</a> and <a class="el" href="p4est__step3_8c.html#abba3d789bf6ffb41a104f37fef7766d6" title="Approximate the flux across a boundary between quadrants. ">step3_upwind_flux()</a>. Now we multiply this by the timestep and add to the current solution.</p>
<p>This function matches the p4est_iter_volume_t prototype used by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>the information about this quadrant that has been populated by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user_data</td><td>the user_data given to <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>: in this case, it points to the timestep. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abba3d789bf6ffb41a104f37fef7766d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_upwind_flux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__iter__face__info__t.html">p4est_iter_face_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Approximate the flux across a boundary between quadrants. </p>
<p>We use a very simple upwind numerical flux.</p>
<p>This function matches the p4est_iter_face_t prototype used by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>the information about the quadrants on either side of the interface, populated by <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user_data</td><td>the user_data given to <a class="el" href="p4est__iterate_8h.html#aca75de06c7e9f039fa3be925a6ae87b4" title="Execute user supplied callbacks at every volume, face, and corner in the local forest. ">p4est_iterate()</a>: in this case, it points to the ghost_data array, which contains the <a class="el" href="structstep3__data__t.html" title="Per-quadrant data for this example. ">step3_data_t</a> data for all of the ghost cells, which was populated by <a class="el" href="p4est__ghost_8h.html#a58908a7bf0810077c99a6ddccc642fcd" title="Transfer data for local quadrants that are ghosts to other processors. ">p4est_ghost_exchange_data()</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6f1dc6e9533b02dea22f550b895e6aa2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void step3_write_solution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structp4est__t.html">p4est_t</a> *&#160;</td>
          <td class="paramname"><em>p4est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timestep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write the state variable to vtk format, one file per process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p4est</td><td>the forest, whose quadrant data contains the state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timestep</td><td>the timestep number, used to name the output files </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
